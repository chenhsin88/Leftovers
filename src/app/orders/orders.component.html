<!-- é é¢æ¨™é¡Œå€åŸŸ -->
<div class="header-section">
  <!-- æ¨™é¡Œå’Œçµ±è¨ˆè³‡è¨Š -->
  <div class="header-content">
    <h1 class="header-title">è¨‚å–®ç®¡ç†</h1>
    <!-- æ¡Œé¢ç‰ˆçµ±è¨ˆæ¨™ç±¤ -->
    <div class="stats-desktop">
      <div class="stat-item pending">
        <div class="stat-dot"></div>
        <span class="stat-text">{{ getStats().pending }} å¾…ä»˜æ¬¾</span>
      </div>
      <div class="stat-item picked-up">
        <div class="stat-dot"></div>
        <span class="stat-text">{{ getStats().pickedUp }} å¾…å–é¤</span>
      </div>
      <div class="stat-item cancelled_by_user">
        <div class="stat-dot"></div>
        <span class="stat-text">{{ getStats().cancelledByUser }} å¾…å–æ¶ˆ</span>
      </div>
    </div>
  </div>
</div>


<!-- è¨‚å–®åˆ—è¡¨é é¢å®¹å™¨ -->
<div class="main-card">

  <!-- ä¸»è¦å…§å®¹å€åŸŸ -->
  <div class="main-content">

    <!-- æœå°‹å’Œç¯©é¸å€åŸŸ -->
    <div class="search-filter-card">
      <div class="search-filter-content">
        <div class="search-filter-row">
          <!-- æœå°‹æ¡† -->
          <div class="search-container">
            <span class="search-icon">ğŸ”</span>
            <input type="text" class="search-input" placeholder="æœå°‹è¨‚å–®ç·¨è™Ÿã€ç”¨æˆ¶åç¨±æˆ–å–é¤ç¢¼" [(ngModel)]="searchTerm" />
          </div>

          <!-- ç‹€æ…‹ç¯©é¸ä¸‹æ‹‰é¸å–® -->
          <div class="filter-container">
            <span class="filter-icon">ğŸ“‹</span>
            <select class="filter-select" [(ngModel)]="statusFilter">
              <option value="all">å…¨éƒ¨ç‹€æ…‹</option>
              <option value="pending">å¾…ä»˜æ¬¾</option>
              <option value="picked_up">å¾…å–é¤</option>
              <option value="cancelled-by-user">å¾…å–æ¶ˆ</option>
            </select>
          </div>
        </div>
      </div>
    </div>

    <!-- è¨‚å–®åˆ—è¡¨å¡ç‰‡ -->
    <div class="order-list-card">

      <!-- æ¡Œé¢ç‰ˆè¡¨æ ¼æ¨™é¡Œ -->
      <div class="table-header">
        <div class="table-header-row">
          <div class="col-order-info">è¨‚å–®è³‡è¨Š</div>
          <div class="col-customer">ç”¨æˆ¶åç¨±</div>
          <div class="col-status">ç‹€æ…‹</div>
          <div class="col-amount">é‡‘é¡</div>
          <div class="col-pickup">å–é¤ç¢¼</div>
          <div class="col-action">æ“ä½œ</div>
        </div>
      </div>

      <!-- è¨‚å–®åˆ—è¡¨å…§å®¹ -->
      <div class="order-list-content">
        <!-- ç©ºç‹€æ…‹é¡¯ç¤º -->
        @if (filteredOrders.length === 0) {
        <div class="empty-state">
          <div class="empty-icon">ğŸ“‹</div>
          <h3 class="empty-title">æ²’æœ‰æ‰¾åˆ°è¨‚å–®</h3>
          <p class="empty-description">è«‹èª¿æ•´æœå°‹æ¢ä»¶æˆ–ç¯©é¸è¨­å®š</p>
          <button class="btn-reset" (click)="resetFilters()">é‡ç½®ç¯©é¸</button>
        </div>
        }

        <!-- è¨‚å–®åˆ—è¡¨é …ç›® -->
        @for (order of filteredOrders; track order.orderNumber) {
        <div class="order-item">

          <!-- æ¡Œé¢ç‰ˆä½ˆå±€ -->
          <div class="order-item-desktop">
            <!-- è¨‚å–®è³‡è¨Šæ¬„ -->
            <div class="col-order-info">
              <div class="order-info">
                <span class="order-number">{{ order.orderNumber }}</span>
                <span class="order-time">
                  <span class="time-icon">ğŸ•</span>
                  {{ order.orderTime }}
                </span>
              </div>
            </div>

            <!-- ç”¨æˆ¶åç¨±æ¬„ -->
            <div class="col-customer">
              <div class="customer-info">
                <span class="customer-name">{{ order.customerName }}</span>
              </div>
            </div>

            <!-- ç‹€æ…‹æ¬„ -->
            <div class="col-status">
              <span [class]="getStatusClass(order.status)">
                {{ getStatusText(order.status) }}
              </span>
            </div>

            <!-- é‡‘é¡æ¬„ -->
            <div class="col-amount">
              <div class="amount-info">
                <span class="amount">NT$ {{ order.totalAmount }}</span>
              </div>
            </div>

            <!-- å–é¤ç¢¼æ¬„ -->
            <div class="col-pickup">
              <span class="pickup-code">{{ order.pickupCode }}</span>
            </div>

            <!-- æ“ä½œæŒ‰éˆ•æ¬„ - ä¿®æ­£é»æ“Šäº‹ä»¶ -->
            <div class="col-action">
              <button class="btn-view" (click)="viewOrderDetail(order.orderNumber)" title="æŸ¥çœ‹è¨‚å–®è©³æƒ…">
                <span>ğŸ”</span>
              </button>
            </div>
          </div>

          <!-- æ‰‹æ©Ÿç‰ˆä½ˆå±€ -->
          <div class="order-item-mobile" (click)="viewOrderDetail(order.orderNumber)">
            <!-- ç¬¬ä¸€è¡Œï¼šè¨‚å–®ç·¨è™Ÿå’Œç‹€æ…‹ -->
            <div class="mobile-row-1">
              <div class="mobile-order-info">
                <div class="order-number">{{ order.orderNumber }}</div>
                <div class="customer-info">
                  <span class="user-icon">ğŸ‘¤</span>
                  <span>{{ order.customerName }}</span>
                </div>
              </div>
              <span [class]="getStatusClass(order.status)">
                {{ getStatusText(order.status) }}
              </span>
            </div>

            <!-- ç¬¬äºŒè¡Œï¼šé‡‘é¡ã€å–é¤ç¢¼å’Œæ“ä½œæŒ‰éˆ• -->
            <div class="mobile-row-2">
              <div class="mobile-details">
                <div class="amount">NT$ {{ order.totalAmount }}</div>
                <div class="pickup-code">{{ order.pickupCode }}</div>
              </div>
              <button class="btn-view" (click)="viewOrderDetail(order.orderNumber); $event.stopPropagation()"
                title="æŸ¥çœ‹è¨‚å–®è©³æƒ…">
                <span>ğŸ‘ï¸</span>
              </button>
            </div>

            <!-- ç¬¬ä¸‰è¡Œï¼šæ™‚é–“è³‡è¨Š -->
            <div class="mobile-row-3">
              <span class="time-icon">ğŸ•</span>
              <span class="order-time">{{ order.orderTime }}</span>
            </div>
          </div>
        </div>
        }
      </div>
    </div>

    <!-- ç¸½è¨ˆè³‡è¨Š -->
    @if (filteredOrders.length > 0) {
    <div class="total-card">
      <div class="total-content">
        <span class="total-label">æœ¬é ç¸½è¨ˆ {{ filteredOrders.length }} ç­†è¨‚å–®</span>
        <span class="total-amount">NT$ {{ getFilteredTotal() }}</span>
      </div>
    </div>
    }
  </div>
</div>
